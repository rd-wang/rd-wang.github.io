---
title: 插入排序
date: 2024-7-18 16:21:37 +0800
categories:
  - 排序算法
tags:
  - 排序
  - 算法
  - 插入排序
description: 插入排序详解
---

# 插入排序

插入排序（Insertion Sort）是一种简单直观的排序算法。它通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。

## 工作原理

1. **初始状态**：假设第一个元素已经排序。
2. **从第二个元素开始**：取出这个元素，在已经排序的元素序列中从后向前扫描。
3. **找到插入位置**：如果已排序序列中的元素大于新元素，将已排序元素向后移动。
4. **插入新元素**：当找到已排序元素小于或等于新元素的位置时，将新元素插入到该位置。

## 图示

![插入排序](https://rd-wang.github.io/assets/img/sort/插入排序.webp)

## 示例

假设有一个待排序的列表：[12, 11, 13, 5, 6]

### 第一步

- 第一个元素 12 已经排序。

### 第二步

- 取出 11，与 12 比较，11 小于 12，交换位置。
[11, 12, 13, 5, 6]

### 第三步

- 取出 13，与 12 比较，13 大于 12，不做交换。
[11, 12, 13, 5, 6]

### 第四步

- 取出 5，与 13 比较，5 小于 13，交换位置。
- 再与 12 比较，5 小于 12，交换位置。
- 再与 11 比较，5 小于 11，交换位置。
[5, 11, 12, 13, 6]

### 第五步

- 取出 6，与 13 比较，6 小于 13，交换位置。
- 再与 12 比较，6 小于 12，交换位置。
- 再与 11 比较，6 大于 5，不做交换。
[5, 6, 11, 12, 13]

## 复杂度分析

- **最坏情况时间复杂度**：O(n²)
- **平均情况时间复杂度**：O(n²)
- **最好情况时间复杂度**：O(n)
- **空间复杂度**：O(1)

插入排序在处理小规模数据或几乎有序的数据时效果较好，但对于大规模数据，其效率较低，因为需要进行大量的比较和移动操作。

## 代码实现

以下是插入排序的Java实现代码：

```java
public class InsertionSort {
    public static void insertionSort(int[] arr) {
        int n = arr.length;
        for (int i = 1; i < n; ++i) {
            int key = arr[i];
            int j = i - 1;

            // 将 arr[0..i-1] 中大于 key 的元素向后移动一位
            while (j >= 0 && arr[j] > key) {
                arr[j + 1] = arr[j];
                j = j - 1;
            }
            arr[j + 1] = key;
        }
    }

    public static void main(String[] args) {
        int[] arr = {12, 11, 13, 5, 6};
        insertionSort(arr);
        for (int i : arr) {
            System.out.print(i + " ");
        }
    }
}
```

