---
title: Android-系统源码进阶学习计划
date: 2025-11-27 9:04:57 +0800
categories:
  - Android
  - Plan
tags:
  - Android
  - Plan
description: Android 半年专家进阶学习计划，目标是帮助你：巩固基础知识（如 Handler、View 绘制）深入掌握 Android Framework 核心原理（如 AMS、WMS、Binder、Zygote）系统性阅读源码并总结面试可表达的理解提供阶段性目标与高质量参考资料
math: true
---

## 第1月：Android系统概览与基础打牢

Android 软件栈由 Linux 内核、HAL、Android 运行时（ART/Dalvik）和 Java 框架层（包括AMS等系统服务）以及应用层组成。本月重点搭建Android源码环境并复习基础架构，每月投入约40小时[developer.android.com](https://developer.android.com/guide/platform#:~:text=,provides%20a%20common%20%20130)。主要学习Android平台各层次结构，并从源码级别了解主要模块，例如消息循环和UI框架。

- **知识点模块：** Android系统架构和源码目录结构（如`frameworks/`、`system/`等）；消息循环原理（`Looper`/`Handler`/`MessageQueue` 源码，路径如`frameworks/base/core/java/android/os/Looper.java`、`Handler.java`）；UI组件绘制流程（`View` 的测量/布局/绘制源码，路径如`View.java`）；Activity生命周期与线程模型复习。
    
- **实践项目建议：** 搭建并编译 AOSP 源码，使用模拟器运行系统镜像，熟悉 `adb` 和 `logcat` 调试常用命令；编写简单应用测试 `Handler.post()` 发送消息的过程，在源码中插入日志追踪消息队列处理；尝试使用 Xposed 或 Frida 对系统服务进行 Hook，如拦截 AMS 调用并打印日志。
    
- **推荐资料：** Android 官方架构文档（Platform Architecture）和 AOSP 源码[developer.android.com](https://developer.android.com/guide/platform#:~:text=,provides%20a%20common%20%20130)；开源书籍如《Android系统源代码情景分析》《Android Internals》；线上博客和视频教程中的源码解析内容。
    
- **阶段性小测：** 典型面试题：什么是 Looper 和 Handler？如何在子线程创建消息循环？Android 应用启动时主线程（ActivityThread）执行了哪些关键步骤？
    

## 第2月：系统启动与进程管理

本月聚焦 Android 系统启动流程和应用进程创建，每月投入约40小时。重点了解 **Zygote 进程** 和 **SystemServer** 的工作机制。官方文档指出 Zygote 是Android系统中所有系统进程和应用进程的“根进程”[source.android.com](https://source.android.com/docs/core/runtime/zygote#:~:text=The%20Zygote%20is%20a%20process,ABI)，它在 init 启动时被创建并加载核心类库，然后通过 `fork` 创建新的进程。阅读 `frameworks/base/core/java/com/android/internal/os/Zygote.java`、`ZygoteInit.java` 源码，理解 Zygote 如何侦听启动命令并 fork 应用进程；阅读 `frameworks/base/services/java/com/android/server/SystemServer.java`，研究 SystemServer 启动步骤及其对 AMS、WMS、PMS 等服务的初始化过程。

- **知识点模块：** Zygote 及其 `fork` 机制（源码路径如 `frameworks/base/core/java/com/android/internal/os/Zygote.java`）；SystemServer 启动流程（`SystemServer.java` 源码）、SystemServer 中的重要服务（AMS/WMS/PMS）初始化；ActivityThread 中的应用主线程初始化（例如 `ActivityThread.systemMain()`）。
    
- **实践项目建议：** 在设备或模拟器上跟踪 Zygote 进程：使用 `adb shell ps` 观察 Zygote PID；通过 `strace` 或 Android Profiler 分析 Zygote 的 `fork` 活动；向 Zygote 相关源码中添加日志，重新编译系统镜像验证效果。使用 `am start` 或应用点击方式启动应用，观察 SystemServer 日志中 AMS/WMS 交互情况，并分析启动时序。
    
- **推荐资料：** 官方 Zygote 文档（Android Open Source 上的 Zygote 概述[source.android.com](https://source.android.com/docs/core/runtime/zygote#:~:text=The%20Zygote%20is%20a%20process,ABI)）、Android 开机流程分析博客文章、系统源码分析书籍（如《Android系统源代码情景分析》相关章节）。
    
- **阶段性小测：** 面试常问：什么是 Zygote 进程，它的作用是什么？请简述 Android 应用从点击图标到界面显示的完整启动流程。SystemServer 进程在启动时会初始化哪些核心服务？
    

## 第3月：核心系统服务

本月集中研究 Android 的核心系统服务，每月投入约40小时。重点阅读 **ActivityManagerService (AMS)** 和 **WindowManagerService (WMS)** 源码，理解它们在系统中的定位。AMS 是 Android 中最核心的服务，负责四大组件的启动、切换、调度及应用进程的管理[doc.yonyoucloud.com](https://doc.yonyoucloud.com/doc/wiki/project/deep-android-v2/activity.html#:~:text=6)；WMS 管理所有应用窗口的创建、布局、层次和动画等功能。学习 AMS 源码（路径如 `frameworks/base/services/core/java/com/android/server/am/ActivityManagerService.java`），特别关注 AMS 如何与 WMS 交互以显示界面。

- **知识点模块：** AMS 的核心职责与架构（`ActivityManagerService.java` 源码），四大组件及进程调度机制；WMS 的基本功能与流程（`WindowManagerService.java` 源码），包括窗口添加、布局、层叠和动画；PackageManagerService 概览（应用安装与权限管理）。
    
- **实践项目建议：** 使用 `adb shell dumpsys activity` 和 `dumpsys window` 命令查看系统状态和日志，编写脚本模拟多个 Activity 切换以观察 AMS/WMS 行为；尝试向 AMS/WMS 源码中添加日志或断点（修改源码后重新部署系统镜像）。利用 `am start`/`am force-stop` 等命令手动触发 Activity/Service 启动与停止，分析 SystemServer 日志。
    
- **推荐资料：** 深入阅读《深入理解 Android 系统（卷II）》中 AMS 章节及相关博客教程[doc.yonyoucloud.com](https://doc.yonyoucloud.com/doc/wiki/project/deep-android-v2/activity.html#:~:text=6)；Android 官方文档和 AOSP 源码；社区技术博客和讲座视频中的 AMS/WMS 源码解读。
    
- **阶段性小测：** 面试必备：AMS 的具体职责是什么？AMS 与 WMS 如何协作启动并显示一个 Activity？WMS 如何管理窗口层次和布局？PackageManagerService 在何时介入应用启动流程？
    

## 第4月：进程间通信与服务管理

本月深入学习 Android 的进程间通信机制，每月投入约40小时。重点掌握 **Binder** 框架和 AIDL。Binder 是 Android 上用于进程间通信的核心机制，它允许一个进程透明地调用另一个进程的方法[source.android.com](https://source.android.com/docs/core/architecture/ipc/binder-overview#:~:text=Binder%20is%20a%20system%20for,completely%20transparent%20to%20the%20caller)。阅读相关源码，如 `frameworks/base/core/java/android/os/Binder.java`、`IBinder.java` 以及底层的 Binder 驱动（`system/core/libbinder/`）。了解 ServiceManager 的作用，它维护系统服务注册表并在应用进程间传递 Binder 对象。

- **知识点模块：** Binder 通信流程（Java 层与 native 层）、Binder 驱动中节点（Binder Node）和代理（Binder Proxy）的原理[source.android.com](https://source.android.com/docs/core/architecture/ipc/binder-overview#:~:text=Binder%20is%20a%20system%20for,completely%20transparent%20to%20the%20caller)；AIDL 工作机制（接口生成的 Stub 与 Proxy 类）；常用系统服务接口（如 IActivityManager）和 ServiceManager 概念。
    
- **实践项目建议：** 编写简单的 AIDL 接口，在两个不同进程中实现并调用自定义服务；使用 `adb shell service list` 和 `service call` 命令调用系统服务接口。使用 `perfetto` 或 `systrace` 捕获并分析一次 Binder 调用的时序。尝试使用 Xposed 或 Frida 在运行时 Hook Binder 通信，打印跨进程调用的参数和日志。
    
- **推荐资料：** 官方 Binder 文档和示例（Android AOSP 文档）[source.android.com](https://source.android.com/docs/core/architecture/ipc/binder-overview#:~:text=Binder%20is%20a%20system%20for,completely%20transparent%20to%20the%20caller)；《深入理解Android系统》Binder 相关章节；GitHub 上的 AIDL 示例项目和系统服务实现；Android 性能与调试工具教程。
    
- **阶段性小测：** 典型面试问答：Binder 通信的基本流程是什么？Binder 驱动在内核中扮演什么角色？AIDL 有什么作用，它是如何生成代码的？什么是 ServiceManager，系统服务如何注册和获取？
    

## 第5月：界面渲染与输入系统

本月深入 Android 的图形界面和输入事件流程，每月投入约40小时。重点理解 **View 系统** 与 **Surface** 的工作原理。阅读 `View` 源码（如 `frameworks/base/core/java/android/view/View.java`），关注 `onMeasure()`、`onLayout()`、`onDraw()` 的实现流程；了解 `ViewRootImpl` 与 `Choreographer` 如何驱动 UI 绘制和帧刷新。学习 `SurfaceFlinger` 的作用（位于 `frameworks/native/services/surfaceflinger/`），理解 WMS 如何与图形系统交互呈现窗口。此外，学习输入子系统：`InputReader` 与 `InputDispatcher`（在 `frameworks/base/services/input/`），了解触摸事件如何从硬件一路传递到应用层。

- **知识点模块：** UI 绘制流程（View 测量/布局/绘制流程源码）、SurfaceFlinger 简介及硬件加速渲染管线；输入事件传递机制（InputManagerService、WindowManagerService、InputDispatcher 的工作流程）。
    
- **实践项目建议：** 编写复杂布局的示例应用，通过 Android Studio Profiler 监测帧率和 GPU 渲染时间；使用 `systrace`/`perfetto` 分析一次 UI 刷新的过程，定位耗时方法；自定义 View，在不同生命周期方法中添加日志输出以理解执行顺序；使用 UI Automator 或 Monkey 工具模拟触摸操作，检查输入事件在日志中的路径。
    
- **推荐资料：** Android 开发者官方文档中的 UI 绘制和性能分析指南；《Android开发艺术探索》《Android Groupie》等系列博客；AOSP 源码阅读资料（如 SurfaceFlinger、Input 子系统相关部分）。
    
- **阶段性小测：** 可能面试题：描述一次完整的界面绘制过程（从测量到绘制）。Android 中触摸事件的传递路径是怎样的？如何使用工具检测 UI 卡顿和过度绘制问题？
    

## 第6月：ART运行时与性能调优 + 面试回顾

最后一个月聚焦 Android 运行时、内存管理与性能优化以及面试准备，每月投入约40小时。学习 **Android Runtime (ART)** 及垃圾回收（GC）机制，了解 JIT/AOT 编译流程、dex2oat 转换、多代垃圾回收策略等。阅读 ART 相关源码或分析文章，掌握类加载与本地方法绑定机制。回顾常见性能问题（如内存泄漏、ANR 原因）以及优化方案。

- **知识点模块：** ART 与 Dalvik 的区别、JIT/AOT 概念；Android 的内存分配与 GC 机制；Android 应用的内存视图和常用运行时库（如 `libart.so`、`libdex.so`）；常见性能陷阱（主线程阻塞、内存泄漏）。
    
- **实践项目建议：** 对示例应用进行性能分析：使用 Android Profiler 监测内存分配和 GC 活动，查找和修复内存泄漏；使用 `systrace`/`perfetto` 跟踪应用的 CPU 和 GPU 活动，定位性能瓶颈；启用 StrictMode 查找违规行为（如在主线程执行 I/O）。模拟高负载场景，观察系统资源占用并尝试优化。
    
- **推荐资料：** 官方 Android 性能分析文档、Dex/ART 相关源码阅读资料；GitHub 上的性能测试和分析工具；Android 性能优化书籍和技术博客；Android 面试题集锦。
    
- **阶段性小测：** 面试重点：ART 与 Dalvik 有何不同？什么是 AOT 和 JIT，何时触发 GC？Android 中有哪些 GC 算法？如何检测并解决内存泄漏？常见 ANR 的原因有哪些，如何优化应用性能？
    

**参考资料：** Android 官方文档（源码说明和架构文档）[developer.android.com](https://developer.android.com/guide/platform#:~:text=,provides%20a%20common%20%20130)[source.android.com](https://source.android.com/docs/core/runtime/zygote#:~:text=The%20Zygote%20is%20a%20process,ABI)[doc.yonyoucloud.com](https://doc.yonyoucloud.com/doc/wiki/project/deep-android-v2/activity.html#:~:text=6)[source.android.com](https://source.android.com/docs/core/architecture/ipc/binder-overview#:~:text=Binder%20is%20a%20system%20for,completely%20transparent%20to%20the%20caller)等；《深入理解Android系统》系列、《Android系统源代码情景分析》、Android Internals 等开源书籍与社区博客。
